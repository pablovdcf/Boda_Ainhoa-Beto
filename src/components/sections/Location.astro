---
import Button from "../ui/Button.astro";

interface Props {
  title: string;
  subtitle: string;
  description: string;
  mapUrl: string;
  mapLabel: string;
  address: string;
  photos: Array<{
    src: string;
    alt: string;
    width: number;
    height: number;
  }>;
}

const { title, subtitle, description, mapUrl, mapLabel, address, photos } = Astro.props;
---

<section id="locationSection" class="section location-section reveal">
  <div class="max-w-6xl mx-auto px-6 grid md:grid-cols-2 gap-10 items-center">
    <div>
      <p class="font-serif text-3xl md:text-4xl mb-3" id="locationTitle">{title}</p>
      <h2 id="locationSubtitle" class="font-serif text-2x1 md:text-2x1 mb-3">{subtitle}</h2>
      <p id="locationDesc" class="mb-4">{description}</p>
      <div class="flex flex-wrap gap-3">
        <Button id="mapLink" href={mapUrl} target="_blank" rel="noopener noreferrer">
          {mapLabel}
        </Button>
        <Button
          variant="outline"
          type="button"
          id="copyAddressBtn"
          data-address={address}
        >
          Copiar dirección
        </Button>
      </div>
      <p id="copyAddressMsg" class="text-sm text-slate-500 mt-3" aria-live="polite"></p>
    </div>
    <div id="locationPhotos" class="location-photos">
      {
        photos.map((photo, index) => (
          <div class={`photo ${index === 0 ? "main" : "secondary"}`}>
            <img
              src={photo.src}
              alt={photo.alt}
              width={photo.width}
              height={photo.height}
              loading={index === 0 ? "eager" : "lazy"}
              decoding="async"
            />
          </div>
        ))
      }
    </div>
  </div>
</section>

<script is:inline>
  const copyBtn = document.getElementById("copyAddressBtn");
  const copyMsg = document.getElementById("copyAddressMsg");
  if (copyBtn) {
    copyBtn.addEventListener("click", async () => {
      const address = copyBtn.getAttribute("data-address") || "";
      if (!address) return;
      try {
        await navigator.clipboard.writeText(address);
        if (copyMsg) copyMsg.textContent = "Dirección copiada.";
      } catch {
        if (copyMsg) copyMsg.textContent = "No se pudo copiar automáticamente.";
      }
    });
  }
</script>

