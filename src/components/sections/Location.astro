---
import Button from "../ui/Button.astro";

interface Props {
  title: string;
  subtitle: string;
  description: string;
  mapUrl: string;
  mapLabel: string;
  address: string;
  photos: Array<{
    src: string;
    alt: string;
    width: number;
    height: number;
  }>;
}

const { title, subtitle, description, mapUrl, mapLabel, address, photos } = Astro.props;
---

<section id="locationSection" class="section location-section">
  <div class="landing-container landing-container-lg">
    <article class="pro-location-shell card p-5 md:p-7">
      <div class="reveal">
        <p class="text-xs uppercase tracking-[0.24em] text-slate-500">Ubicaci칩n</p>
        <h2 class="font-serif text-3xl md:text-4xl mt-3 text-night" id="locationTitle">{title}</h2>
        <p id="locationSubtitle" class="text-slate-700 mt-3">{subtitle}</p>
        <p id="locationDesc" class="text-slate-600 mt-3">{description}</p>
        <div class="flex flex-wrap gap-3 mt-5">
        <Button id="mapLink" href={mapUrl} target="_blank" rel="noopener noreferrer">
          {mapLabel}
        </Button>
        <Button
          variant="outline"
          type="button"
          id="copyAddressBtn"
          data-address={address}
        >
          Copiar direcci칩n
        </Button>
        </div>
        <p id="copyAddressMsg" class="text-sm text-slate-500 mt-3" aria-live="polite"></p>
      </div>

      <div id="locationPhotos" class="location-photos pro-location-photos reveal reveal-delay-1">
        {
          photos.map((photo, index) => (
            <div class={`photo ${index === 0 ? "main" : "secondary"}`}>
              <img
                src={photo.src}
                alt={photo.alt}
                width={photo.width}
                height={photo.height}
                loading={index === 0 ? "eager" : "lazy"}
                decoding="async"
              />
            </div>
          ))
        }
      </div>
    </article>
  </div>
</section>

<script is:inline>
  const copyBtn = document.getElementById("copyAddressBtn");
  const copyMsg = document.getElementById("copyAddressMsg");
  if (copyBtn) {
    copyBtn.addEventListener("click", async () => {
      const address = copyBtn.getAttribute("data-address") || "";
      if (!address) return;
      try {
        await navigator.clipboard.writeText(address);
        if (copyMsg) copyMsg.textContent = "Direcci칩n copiada.";
      } catch {
        if (copyMsg) copyMsg.textContent = "No se pudo copiar autom치ticamente.";
      }
    });
  }
</script>
